# 多态

多态性是面向对象程序设计（OOP）的核心思想，其字面意思是多种形态。

## 一、静态多态

静态多态就是在编译期间就可以确定每个对象调用函数（非虚函数）的地址，例如：函数的重载，对象名加点操作符执行成员函数等，都是静态多态，这也叫做早期绑定（也叫做静态绑定）。主要有函数重载和函数模板（这里只写函数重载）。

## 二、动态多态

动态多态则是利用虚函数实现了运行时的多态，也就是说在系统编译的时候并不知道程序将要调用哪一个函数，只有在运行到这里的时候才能确定接下来会跳转到哪一个函数的栈帧。

### 1）虚函数

虚函数就是在基类中声明该函数是虚拟的（在函数之前加virtual关键字），然后在子类中正式的定义（子类中的该函数的函数名，返回值，函数参数个数，参数类型，全都与基类的所声明的虚函数相同，此时才能称为重写，才符合虚函数，否则就是函数的重载），再定义一个指向基类对象的指针，然后使该指针指向由该基类派生的子类对象，再然后用这个指针来调用改虚函数，就能实现动态多态。

对于某些函数，基类希望它的派生类各自定义适合自身的版本，此时基类就将这些函数声明成虚函数。

基类通过在其成员函数的声明语句之前加上关键字 virtual 使得该函数执行动态绑定。关键字 virtual 只能出现在类内部的声明语句之前而不能用于类外部的函数定义。

任何构造函数之外的非静态函数都可以是虚函数。

如果基类把一个函数声明成虚函数，则该函数在派生类中隐式地也是虚函数。当然，我们可以再一次使用 virtual 关键字指出该函数的性质。

在 C++11 中我们可以使用 override 关键字来说明派生类中的虚函数。如果我们使用 override 标记了某个函数，但该函数并没有覆盖已存在的虚函数，此时编译器将报错。

通常情况下，如果我们不使用某个函数，则无须为该函数提供定义。但是我们必须为每一个虚函数都提供定义，而不管它是否被用到了，这是因为连编译器也无法确定到底会使用哪个虚函数。

### 2）纯虚函数

我们通过在函数体的位置（即在声明语句的分号之前）书写 =0; 示例如下

```c++
class A
{
public:
	A(){}
	~A(){}
	
private:
	virtual void func() = 0;
}
```

此时func()函数这时候就是纯虚函数。其中=0，只能出现在类内部的虚函数声明语句处。和普通的虚函数不一样，一个纯虚函数无需定义。我们可以将纯虚函数的函数体定义在类的外部，但不能在类的内部为一个=0 的函数提供函数体。含有（或者未经覆盖直接继承）纯虚函数的类是抽象基类。抽象基类负责定义接口，而后续的其他类可以覆盖该接口。我们不能（直接）创建一个抽象基类的对象。

纯虚函数的定义告诉子类，该接口必须被实现。

## 三、多态的实现

C++中虚函数表的作用主要是实现了多态的机制。首先先解释一下多态的概念，多态是c++的特点之一，关于多态，简而言之就是 用父类的指针指向其子类的实例，然后通过父类的指针调用实际子类的成员函数，这种方法呢，可以让父类的指针具有多种形态，也就是说不需要改动很多的代码就可以让父类这一种指针，干一些很多子类指针的事情，这里是从虚函数的实现机制层面进行研究

## 四、虚函数和纯虚函数比较

纯虚函数：函数一定没有被实现，只是为了定义一个接口规范，子类必须重写，

虚函数：函数不一定没有被实现，子类不一定要重写
