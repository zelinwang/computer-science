## 一、模块设计原则

1. 明确职责，模块独立
2. 信息隐蔽，隐藏细节
3. 简化接口

## 二、模块设计

### 1.1 耦合：模块之间的联系紧密程度

1. 非直接耦合
两个模块之间没有直接关系，它们之间的联系完全时通过主模块的控制和调用来实现的。耦合度最低，模块独立性最强
2. 数据耦合
模块之间有调用关系，传递的是简单的数据值
3. 标记耦合
模块之间有调用关系，传递的是数据结构。如数组名、文件名，其实传递的是这个数据结构的地址。
4. 控制耦合
模块之间有调用关系，传递的是控制变量（如开关、标志等），被调用模块通过控制变量的值有选择地执行某一功能。
5. 外部耦合
多个模块都访问同一全局简单变量，不是同一数据结构，不是通过参数表传递该变量的信息
6. 公共耦合
多个模块都访问同一公共数据环境，如全局数据结构，共享通信区.
7. 内容耦合
一个模块直接使用另一个模块的内部数据，或则通过非正常入口而转入另一个模块内部，是最差的耦合。

### 1.2 内聚：模块内部各元素联系的紧密程度

1. 功能内聚
模块内所有元素共同完成某一功能，联系紧密，缺一不可，是最强的内聚类型。
2. 顺序内聚
模块完成多个功能，这些功能顺序执行，各功能之间有数据传递。
3. 通信内聚
模块内所有处理元素都在同一个数据结构上操作，或则指各处理使用相同的输入数据或者产生相同的输出数据。
4. 过程内聚
模块完成多个功能，这些功能顺序执行，各功能之间可能没有数据传递。
5. 时间内聚
把需要同时执行的动作组合在一起，所有动作在统一时间段内执行。如初始化
6. 逻辑内聚
把机重相关的功能组合在一起，每次调用时，由传送给模块的参数来确定该模块应完成哪一种功能。
7. 偶然内聚
模块内各部分之间没有联系，或则有联系，这种联系也很松散，最弱的内聚类型。如初学C语言时，所有代码都写在主函数里面。

### 1.3 其他

深度：软件结构中模块控制的层数
宽度：软件结构中同一个层次上的模块总数的最大值
扇出：一个模块直接控制（调用）的下层模块数
扇入：一个模块被几个上级模块调用。

### 1.4 模块设计注意事项

保持模块的大小适中
尽可能减少调用的深度
扇入大，扇出小。
顶层高扇出，中间层扇出减少，低层高扇入
保证模块是单入口、单出口的
模块的作用域应该在模块之内
功能应该是可预测的



越底层的模块，应该越稳定，越抽象，越具有高复用度。稳定的最直观表现就是暴漏的API很久都不用变化，隐藏变化因子，避免传递给依赖它的模块。稳定的API越抽象，复用度越高。

ps：金山wps代码暴漏出的API（通常以_XXX()开头的接口），轻易不改变。当然在其之上还有一些类

减少依赖，避免模块依赖不稳定的模块。模块稳定性会传递：B模块依赖于A模块，如果B模块很稳定，但是A模块不稳定，那么B模块也会变的不稳定。如果，A中代码段x是高复用的代码段，那么无妨将X单独做成一个模块X；如果，x是一个简单的方法或函数，不太适合做成一个模块，那就将x代码拷贝到B中，这样可以保证模块的稳定性和自完备性。

提升模块的复用度，自完备性有时候要优于代码复用。自完备性：尽可能的依赖少的模块来达到代码可复用。

每个模块只做好一件事情，不要让Common出现。模块化结构是让工程结构更清晰，每个模块都只做一件事情，都有自己的一个命名，这样这个模块才能良性发展。Common非常不稳定，大量依赖，全是耦合，整个模块无法复用到其它APP。

模块从上到下依赖，业务模块之间也尽量不要耦合。



作者：成为_5995
链接：https://www.jianshu.com/p/bbdbb44abf26
来源：简书
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。